<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/white.css">
		<link rel="stylesheet" href="plugin/highlight/zenburn.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<div class="logos" style="display: flex; justify-content: space-between; position: relative;">
						<img src="./mongo-logo.svg" alt="MongoDB" width="200" height="100">
						<img src="./nodejs-logo.svg" alt="NodeJS" width="200" height="100" style="filter: invert(84%) sepia(16%) saturate(35%) hue-rotate(325deg) brightness(106%) contrast(89%);">
					</div>
					<h1 style="font-size: 3.5rem; font-weight: 400; text-transform: none; position: relative; top: 120px;">MongoDB with NodeJS</h1>
					<p style="font-size: 1.2rem; margin-top: 370px;">Bronislav Shevelev</p>
					<p style="font-size: 1.2rem;">Rolling Scopes School</p>
					<p style="font-size: 1.2rem;">2022</p>
					<aside class="notes">
						Self-introduction
						Topic of the presentation
					</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; top: -100px;">Agenda</h2>
					<ul style="font-size: 2rem;">
						<li style="margin-bottom: 20px;">Introduction</li>
						<li style="margin-bottom: 20px;">Work Arrangement</li>
						<li style="margin-bottom: 20px;">Create</li>
						<li style="margin-bottom: 20px;">Read</li>
						<li style="margin-bottom: 20px;">Update</li>
						<li>Delete</li>
					</ul>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; top: 30px;">Introduction</h2>
					<img src="./Introduction.png" alt="Mongo vs SQL">
					<p style="font-size: 8px; position: relative; top: -20px; text-align: start;">Source: MongoDB documentation. https://www.mongodb.com/docs/</p>
					<aside class="notes">
						- 2 major ways of keeping data in a database: SQL -> relational databases
						- MongoDB -> JSON (BSON) objects, we can use nested objects
						- In the picture: query the same data, but with MongoDB code is more elegant
					</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; top: 30px; margin-bottom: 50px;">Online store</h2>
					<div style="max-width: 100%; position: relative; display: grid; grid-template-columns: repeat(3, 1fr);">
						<div>
							<img src="./iphone11.jpeg" alt="iPhone11" width="200" height="auto">
							<pre style="font-size: 18px;"> 
								<code>
const iPhone11 = {
	manufacturer: 'Apple',
	brand: 'iPhone',
	model: '11',
	features: {
			cameras: 2,
			memory: 128,
	},
	price: 448,
};	
								</code>
							</pre>
						</div>
						<div>
							<img style="position: relative; top: -30px;" src="./iphone13.jpg" alt="iPhone13" width="260" height="auto">
							<pre style="position: relative; top: -60px; font-size: 18px;">
								<code>
const iPhone13Pro = {
	manufacturer: 'Apple',
	brand: 'iPhone',
	model: '13 Pro',
	features: {
			cameras: 3,
			memory: 256,
	},
	price: 1099,
};
								</code>
							</pre>
						</div>
						<div>
							<img style="position: relative; top: -20px;" src="./samsungS22.png" alt="Samsung" width="236">
							<pre style="position: relative; top: -36px; font-size: 18px;">
								<code>
const samsungS22 = {
	manufacturer: 'Samsung',
	brand: 'Galaxy',
	model: 'S22',
	features: {
			cameras: 3,
			memory: 256,
	},
	price: 799.99,
};	
								</code>
							</pre>
						</div>
					</div>
					<aside class="notes">
						- Quick project: online store seliing cell phones.
						- 3 models
						- Properties: manufacturer, brand, model, features (number of cameras and storage space), price
					</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; top: -20px; margin-bottom: 50px;">Work Arrangement</h2>
					<div>
						<div style="width: 100%; display: grid; grid-template-columns: 1fr 1fr; justify-items: start; align-content: space-evenly; align-items: center;">
							<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; top: 100px; margin-top: 20px;">Project initialization:</h4>
							<pre style="position: relative; font-size: 20px;">
								<code>
 npm init -y
								</code>
							</pre>
							<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; margin-top: 20px;">MongoDB database driver installation:</h4>
							<pre style="position: relative; font-size: 20px;">
								<code>
 npm install mongodb
								</code>
							</pre>
							<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; margin-top: 20px;">Running the  server:</h4>
							<pre style="position: relative; font-size: 20px;">
								<code>
 ./mongod --dbpath=data
								</code>
							</pre>
							<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; margin-top: 20px;">Use of the MongoDB module:</h4>
							<pre style="position: relative; font-size: 20px;">
								<code>
 const mongo = require('mongodb');
								</code>
							</pre>
						</div>
					</div>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; top: 10px; margin-bottom: 40px;">Create</h2>
					<div>
						<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; text-align: start;">Create a database:</h4>
						<div style="display: flex; justify-content: space-between; align-items: center;">
							<span style="font-size: 1rem; font-weight: 400;">1)</span>
							<pre style="font-size: 1rem;">
								<code>const MongoClient = require('mongodb').MongoClient;</code>
							</pre>
						</div>
						<div style="display: flex; justify-content: space-between; align-items: center;">
							<span style="font-size: 1rem; font-weight: 400;">2)</span>
							<pre style="font-size: 1rem;">
								<code>import { MongoClient } from 'mongodb';</code>
							</pre>
						</div>
						<pre style="font-size: 1rem; position: relative; left: 7px;">
							<code>
const myDBName = 'store';
const url = 'mongodb://localhost:27017';
const client = new MongoClient(url);

async function main() {
	try {
		await client.connect();
		const db = client.db(myDBName);
	} catch (e) {
		console.error(e);
	} finally {
		await client.close();
	}
}
await main();
							</code>
						</pre>
					</div>
					<aside class="notes">
						- Connection and operations are async operations -> async function created
						- In case of errors, I wrap the code in a try...catch block to handle them
						- I include "finally" to close the connections in either case
					</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; top: -60px; margin-bottom: 50px;">Create</h2>
					<div>
						<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; text-align: start; position: relative; top: -90px;">Create a collection:</h4>
						<pre style="font-size: 1rem; position: relative; left: 7px; position: relative; top: -80px;">
							<code>
async function main() {
	try {
		await client.connect();
		const db = client.db(myDBName);
		
		const collection = db.collection('products');
		await collection.insertOne(iPhone11);
    await collection.insertMany([iPhone13Pro, samsungS22]);
		
	} catch (e) {
		console.error(e);
	} finally {
		await client.close();
	}
}
await main();
							</code>
						</pre>
					</div>
					<aside class="notes">
						- Collection in MongoDB = table in SQL
						- Document in MongoDB = record in SQL
						- We can insert one by one or several documents at once
					</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; margin-bottom: 50px; top: 30px;">Read</h2>
					<div>
						<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; text-align: start; position: relative; top: -10px;">Read the database (single output):</h4>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">mongo.js</h5>
								<pre style="font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code>
async function main() {
	try {
		await client.connect();
		const db = client.db(myDBName);
		const collection = db.collection('products');

		const findResult = await collection.findOne({brand: 'iPhone'});
		
		console.log('Found documents =>', findResult);
	} catch (e) {
		console.error(e);
	} finally {
		await client.close();
	}
}
await main();
									</code>
								</pre>
							</div>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">Terminal</h5>
								<pre style="font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code class="fragment">
$ node mongo.js
Found documents => {
	_id: new ObjectId("62f998fe89d7fdc056854b4a"),
	manufacturer: 'Apple',
	brand: 'iPhone',
	model: '11',
	features: { cameras: 2, memory: 128 },
	price: 448
}
									</code>
								</pre>
							</div>
							<aside class="notes">
								- findOne() returns the first occurrence
								- let's find a document with the brand "iPhone"
								- we have 2 such documents, but got just one
							</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; margin-bottom: 50px; top: 30px;">Read</h2>
					<div>
						<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; text-align: start; position: relative; top: -10px;">Read the database (multiple outputs):</h4>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">mongo.js</h5>
								<pre style="font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code>
async function main() {
	try {
		await client.connect();
		const db = client.db(myDBName);
		const collection = db.collection('products');

		const findResult = await collection.find().toArray();
		
		console.log('Found documents =>', findResult);
	} catch (e) {
		console.error(e);
	} finally {
		await client.close();
	}
}
await main();
									</code>
								</pre>
							</div>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">Terminal</h5>
								<pre style="max-height: 50px; font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code style="max-height: 160px;" class="fragment">
$ node mongo.js
Found documents => [
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4a"),
    manufacturer: 'Apple',
    brand: 'iPhone',
    model: '11',
    features: { cameras: 2, memory: 128 },
    price: 448
  },
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4b"),
    manufacturer: 'Apple',
    brand: 'iPhone',
    model: '13 Pro',
    features: { cameras: 3, memory: 256 },
    price: 1099
  },
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4c"),
    manufacturer: 'Samsung',
    brand: 'Galaxy',
    model: 'S22',
    features: { cameras: 3, memory: 256 },
    price: 799.99
  }
]
									</code>
								</pre>
							</div>
							<aside class="notes">
								- find() searches for all documents
							</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; margin-bottom: 50px; top: 30px;">Read</h2>
					<div>
						<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; text-align: start; position: relative; top: -10px;">Read the database (filter):</h4>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">mongo.js</h5>
								<pre style="font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code>
async function main() {
	try {
		await client.connect();
		const db = client.db(myDBName);
		const collection = db.collection('products');

		const findResult = await collection.find({'features.cameras': {$gt: 2}}).toArray();
		
		console.log('Found documents =>', findResult);
	} catch (e) {
		console.error(e);
	} finally {
		await client.close();
	}
}
await main();
									</code>
								</pre>
							</div>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">Terminal</h5>
								<pre style="max-height: 50px; font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code style="max-height: 160px;" class="fragment">
$ node mongo.js
Found documents => [
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4b"),
    manufacturer: 'Apple',
    brand: 'iPhone',
    model: '13 Pro',
    features: { cameras: 3, memory: 256 },
    price: 1099
  },
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4c"),
    manufacturer: 'Samsung',
    brand: 'Galaxy',
    model: 'S22',
    features: { cameras: 3, memory: 256 },
    price: 799.99
  }
]
									</code>
								</pre>
							</div>
							<aside class="notes">
								- we can apply filters, even with nested documents
								- $gt is the "greater than" operator
								- let's find documents where phones have more than 2 cameras
							</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; margin-bottom: 50px; top: 30px;">Update</h2>
					<div>
						<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; text-align: start; position: relative; top: -10px;">Update a single document:</h4>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">mongo.js</h5>
								<pre style="font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code>
async function main() {
	try {
		await client.connect();
		const db = client.db(myDBName);
		const collection = db.collection('products');

		await collection.updateOne({brand: 'Galaxy'}, {$set: {price: 699.99}});
    
		const findResult = await collection.findOne({brand: 'Galaxy'});
    console.log('Found documents =>', findResult);
	} catch (e) {
		console.error(e);
	} finally {
		await client.close();
	}
}
await main();
									</code>
								</pre>
							</div>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">Terminal</h5>
								<pre style="max-height: 50px; font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code style="max-height: 160px;" class="fragment">
$ node mongo.js
Found documents => [
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4c"),
    manufacturer: 'Samsung',
    brand: 'Galaxy',
    model: 'S22',
    features: { cameras: 3, memory: 256 },
    price: 699.99
  }
]
									</code>
								</pre>
							</div>
							<aside class="notes">
								- updateOne() can be used for updating a single value
								- price of Galaxy S22 was 799.99, let's make it 699.99
								- use the $set operator for updating a value
							</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; margin-bottom: 50px; top: 30px;">Update</h2>
					<div>
						<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; text-align: start; position: relative; top: -10px;">Update multiple documents:</h4>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">mongo.js</h5>
								<pre style="font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code>
async function main() {
	try {
		await client.connect();
		const db = client.db(myDBName);
		const collection = db.collection('products');

		collection.updateMany({brand: 'iPhone'}, {$inc: {price: -100}});

    const findResult = await collection.find({brand: 'iPhone'}).toArray();
    console.log('Found documents =>', findResult);
	} catch (e) {
		console.error(e);
	} finally {
		await client.close();
	}
}
await main();
									</code>
								</pre>
							</div>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">Terminal</h5>
								<pre style="max-height: 50px; font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code style="max-height: 160px;" class="fragment">
$ node mongo.js
Found documents => [
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4a"),
    manufacturer: 'Apple',
    brand: 'iPhone',
    model: '11',
    features: { cameras: 2, memory: 128 },
    price: 348
  },
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4b"),
    manufacturer: 'Apple',
    brand: 'iPhone',
    model: '13 Pro',
    features: { cameras: 3, memory: 256 },
    price: 999
  }
]
									</code>
								</pre>
							</div>
							<aside class="notes">
								- with updateMany(), we can update multiple documents at once
								- offer a $100 discount on iPhones 
								- we can perform math operations: $inc (increment) 
								- decrease the price with $inc and passing -100
							</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; margin-bottom: 50px; top: 30px;">Delete</h2>
					<div>
						<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; text-align: start; position: relative; top: -10px;">Delete a single document:</h4>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">mongo.js</h5>
								<pre style="font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code>
async function main() {
	try {
		await client.connect();
		const db = client.db(myDBName);
		const collection = db.collection('products');

		await collection.deleteOne({brand: 'Galaxy'}); 

    const findResult = await collection.find().toArray();
    console.log('Found documents =>', findResult);
	} catch (e) {
		console.error(e);
	} finally {
		await client.close();
	}
}
await main();
									</code>
								</pre>
							</div>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">Terminal</h5>
								<pre style="max-height: 50px; font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code style="max-height: 160px;" class="fragment">
$ node mongo.js
Found documents => [
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4a"),
    manufacturer: 'Apple',
    brand: 'iPhone',
    model: '11',
    features: { cameras: 2, memory: 128 },
    price: 348
  },
  {
    _id: new ObjectId("62f998fe89d7fdc056854b4b"),
    manufacturer: 'Apple',
    brand: 'iPhone',
    model: '13 Pro',
    features: { cameras: 3, memory: 256 },
    price: 999
  }
]
									</code>
								</pre>
							</div>
							<aside class="notes">
								- we can use deleteOne() to delete a single document
								- let's delete the Galaxy brand from our collection
							</aside>
				</section>
				<section>
					<h2 style="font-size: 3rem; font-weight: 400; text-transform: none; position: relative; margin-bottom: 50px; top: 30px;">Delete</h2>
					<div>
						<h4 style="font-size: 1.7rem; font-weight: 400; text-transform: none; text-align: start; position: relative; top: -10px;">Delete multiple documents:</h4>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">mongo.js</h5>
								<pre style="font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code>
async function main() {
	try {
		await client.connect();
		const db = client.db(myDBName);
		const collection = db.collection('products');

		await collection.deleteMany({brand: 'iPhone'}); 

    const findResult = await collection.find().toArray();
    console.log('Found documents =>', findResult);
	} catch (e) {
		console.error(e);
	} finally {
		await client.close();
	}
}
await main();
									</code>
								</pre>
							</div>
							<div>
								<h5 style="font-size: 1rem; font-weight: 400; text-transform: none; position: relative;">Terminal</h5>
								<pre style="max-height: 50px; font-size: 0.8rem; position: relative; left: 7px; position: relative;">
									<code style="min-height: 140px;" class="fragment">
$ node mongo.js
Found documents => []
									</code>
								</pre>
							</div>
							<aside class="notes">
								- we can delete multiple documents from a collection with deleteMany()
								- let's remove the 2 iPhone brands
								- the output is empty -> no documents in the collection
							</aside>
				</section>
				<section>Thank you!
					<aside class="notes">
						- MongoDB is an awesome tool: has all the CRUD operations
						- allows to do indexing, aggregations, and much more 
						- popular in the world
						- good to know for future career
					</aside>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
